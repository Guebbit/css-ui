@import "index";

$scss-library-prefix: "" !default;
$circular-progress-bar-css-color: #000 !default;
$circular-progress-bar-css-on-color: guebbit-contrast($circular-progress-bar-css-color) !default;
$circular-progress-bar-css-background: transparent !default;
$circular-progress-bar-css-text-color: guebbit-contrast($circular-progress-bar-css-background) !default;

@property --circular-progress-bar-css-percentage {
  syntax: '<number>';
  inherits: true;
  initial-value: 0;
}

@keyframes circular-progress-bar-css-animation {
  0% { --circular-progress-bar-css-percentage: 0; }
  100% { --circular-progress-bar-css-percentage: var(--value); }
}

%#{$scss-library-prefix}circular-progress-bar-css,
.#{$scss-library-prefix}circular-progress-bar-css {
  --circular-progress-bar-css-percentage: var(--value);
  width: 100%;
  animation: circular-progress-bar-css-animation 2s 0.5s forwards;
  aspect-ratio: 1;
  border-radius: 50%;
  position: relative;
  overflow: hidden;
  display: grid;
  place-items: center;

  background-color: var(--circular-progress-bar-css-background, $circular-progress-bar-css-background);
  color: var(--circular-progress-bar-css-text-color, $circular-progress-bar-css-text-color);

  &::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: conic-gradient(var(--circular-progress-bar-css-color, $circular-progress-bar-css-color) calc(var(--circular-progress-bar-css-percentage) * 1%), var(--circular-progress-bar-css-on-color, $circular-progress-bar-css-on-color) 0);
    mask: radial-gradient(white 55%, transparent 0);
    mask-mode: alpha;
    -webkit-mask: radial-gradient(#0000 55%, #000 0);
    -webkit-mask-mode: alpha;
  }

  &::after {
    counter-reset: percentage var(--value);
    content: counter(percentage) '%';
    font-family: Helvetica, Arial, sans-serif;
    font-size: 5em;
  }

  &.numberless-mode {
    &::after {
      content: none;
    }
  }

  &.simplified-mode {
    &:before{
      mask: none;
      -webkit-mask: none;
    }
  }
}